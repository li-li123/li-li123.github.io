## 1. 下载依赖库
```shell
go get -u github.com/spf13/viper
```
## 2. 初始化配置
```go
package config

import (
    "github.com/fsnotify/fsnotify"
    "github.com/spf13/viper"
    log "github.com/sirupsen/logrus"
)

type MikanConfig struct {
    ServerConfig ServerConfig `mapstructure:"server"`
    DBConfig DBConfig `mapstructure:"db"`
    SpiderConfig SpiderConfig `mapstructure:"spider"`
    TransmissionRpcDownloaderConfig TransmissionRpcDownloaderConfig `mapstructure:"transmission"`
    Message Message `mapstructure:"message"`
}

type ServerConfig struct {
    Port int `mapstructure:"port"`
    LogPath string `mapstructure:"logPath"`
    LogLevel string `mapstructure:"logLevel"`
    ConfigPath string `mapstructure:"configPath"`
}

type DBConfig struct {
    URL string `mapstructure:"url"`
}

type TransmissionRpcDownloaderConfig struct {
    DbURL string `mapstructure:"dbUrl"`
    AliPanRootPath string `mapstructure:"aliPanRootPath"`
    DownloadRootPath string `mapstructure:"downloadRootPath"`
    TransmissionUrl string `mapstructure:"transmissionUrl"`
    TransmissionUser string `mapstructure:"transmissionUser"`
    TransmissionPassword string `mapstructure:"transmissionPassword"`
}

type SpiderConfig struct {
    Cookie string `mapstructure:"cookie"`
    CookiePath string `mapstructure:"cookiePath"`
    Username string `mapstructure:"username"`
    Password string `mapstructure:"password"`
}

type Message struct {
    EmailMessage EmailMessage `mapstructure:"email"`
}

type EmailMessage struct {
    Password string `mapstructure:"password"`
    Username string `mapstructure:"username"`
    Host string `mapstructure:"host"`
    TargetEmail string `mapstructure:"targetEmail"`
    Port string `mapstructure:"port"`
}

func InitConfig(configPath string) *MikanConfig {
    config := &MikanConfig{}
    v := viper.New()
    v.SetConfigFile(configPath)
    // 读取配置
    err := v.ReadInConfig()
    if err != nil {
        panic(err)
    }
    // 赋值给结构体
    err = v.Unmarshal(config)
    if err != nil {
        panic(err)
    }
    // 更新配置
    v.WatchConfig()
    v.OnConfigChange(func(event fsnotify.Event) {
        err := v.ReadInConfig()
        if err != nil {
            log.Panicln("配置更新失败")
        }
        err = v.Unmarshal(config)
        if err != nil {
            log.Panicln("配置更新失败")
        }
    })
    return config
}

```