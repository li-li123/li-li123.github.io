## B 树

> 这个世界上根本就没有 `B-树`, `B-树` 就是 B 树, 早期技术文档乱翻译罢了
>
> B树的种族如下
>
> * B 树
> * B+ 树
> * B* 树

---

B 树的定义

B树可以看做是对二叉查找树的一种扩展，M 阶他允许每个节点都有 M-1 个子节点。B 树在对磁盘IO的优化更好，通过设置一个节点的大小等于磁盘单位页面的大小，以实现最优化大块数据的读和写操作。

一个 M 阶的 B 树，特性如下：

- 每个节点最多有个 M 棵子树；
- 除根节点外，其他每个分支至少有个 m/2 棵子树
- 根节点至少有两棵子树
- 所有叶节点在同一层
- 有 j 个孩子的非叶节点恰好有 j-1 个关键码，关键码按递增次序排列。

B树结构和红黑树原理上有些类似，但是B树在对磁盘IO的优化更好。它与红黑树的不同之处在于，B树的节点可以有很多个孩子，从数个到上千个都有可能。每个含有n个节点的红黑树，高度为 O(lgn) ,所以可以在 lgn 的时间内完成一些动态集合的操作。

B 树之所以可以降低磁盘 IO ，是由于 B 树充分考虑到了磁盘的结构特点。磁盘在读取数据，需要移动磁臂，转圈圈，速度特别慢，所以引入了页面概念，即一些连续的存储空间，来减少 IO 操作。一页的长度大约在 211 到 214 字节，而我们经常看到的B数的分支因子 50~2000 正是根据对应一页的大小。这样便可以最大程度上降低对磁盘的 I/O 操作次数，进而提升性能。

## B + 树



B树的变型，他把数据都存储在叶子节点上，内部只存储关键字和孩子指针，以叶子中最小值作为索引。B+数遍历高效，所有叶子节点串联成链表即可从头到尾遍历。

- 有n棵子树的节点含有n个关键字，每个关键字都不会保存数据，只会用来索引，所有数据都保存在叶子节点。
- 所有叶子节点包含所有关键字信息以及指向关键字的指针，关键字顺序从小到大。



**为什么B+树比B树更适合做系统的数据库索引和文件索引**：

1. B+树的磁盘读写代价更低

   > 因为B+树内部节点没有指向关键字具体信息的指针，内部 节点比B树小

2. B+树的查询更加稳定

   > 所有关键字查询的长度都是一样的。

## B + 比 B树 的好处

1. B+ 树查询性能稳定

> 每个记录都存在叶子节点, 每个记录的查询记录都经过相同的时间

2. B+ 的磁盘IO更少

> B+树的**内部结点并没有指向关键字具体信息的指针**，其内部结点比B树小，盘块能容纳的结点中关键字数量更多，一次性读入内存中可以查找的关键字也就越多，相对的，IO读写次数也就降低了。而IO读写次数是影响索引检索效率的最大因素。

3. B+ 的范围查询更简便

> B+ 树中记录都存在叶子节点节点中, 并且已有序链表排列起来, 这样可以迅速的范围查找和排序