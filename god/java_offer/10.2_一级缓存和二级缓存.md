MySql 在执行 sql 命令之前需要编译 sql，当重复查询相同的 sql 语句时，如果每次都需要重新编译将造成资源的巨大浪费，因此 Mybatis 提供了一级缓存方法，来优化在与数据库会话间重复查询的问题。每一个 sqlSession 在持有了自己的 Executor 都会有一个 localCache 。在执行查询的时候将会将当前执行的 MappedStatement 生成一个 key ，并去 localCache 中查询，查询到再去数据库中进行查询。一句话概括的话，可以说一级缓存缓存的是编译好的 sql 语句。

<center><img src="https://ning-wang.oss-cn-beijing.aliyuncs.com/blog-imags/1569851110714-aa72a916-6df0-4058-a7c3-fcfea0577efa.png" alt="1569851110714-aa72a916-6df0-4058-a7c3-fcfea0577efa"  /></center>

二级缓存，一级缓存的范围是一个 sqlSession ，而二级缓存就是用来让多个 SqlSession 共享缓存。开启二级缓存之后，将会在CacheExecutor 装饰 Executor ，在查询之前会现在 CachingExecutor 进行二级缓存查询。

<center><img src="https://ning-wang.oss-cn-beijing.aliyuncs.com/blog-imags/1569851110601-265cd387-e890-4df6-80b8-b14598aeead8.png" alt="1569851110601-265cd387-e890-4df6-80b8-b14598aeead8"  /></center>





