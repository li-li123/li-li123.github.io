## é¢˜ç›®

> [å‰‘æŒ‡ Offer 47. ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼](https://leetcode-cn.com/problems/li-wu-de-zui-da-jie-zhi-lcof/)

åœ¨ä¸€ä¸ª m*n çš„æ£‹ç›˜çš„æ¯ä¸€æ ¼éƒ½æ”¾æœ‰ä¸€ä¸ªç¤¼ç‰©ï¼Œæ¯ä¸ªç¤¼ç‰©éƒ½æœ‰ä¸€å®šçš„ä»·å€¼ï¼ˆä»·å€¼å¤§äº 0ï¼‰ã€‚ä½ å¯ä»¥ä»æ£‹ç›˜çš„å·¦ä¸Šè§’å¼€å§‹æ‹¿æ ¼å­é‡Œçš„ç¤¼ç‰©ï¼Œå¹¶æ¯æ¬¡å‘å³æˆ–è€…å‘ä¸‹ç§»åŠ¨ä¸€æ ¼ã€ç›´åˆ°åˆ°è¾¾æ£‹ç›˜çš„å³ä¸‹è§’ã€‚ç»™å®šä¸€ä¸ªæ£‹ç›˜åŠå…¶ä¸Šé¢çš„ç¤¼ç‰©çš„ä»·å€¼ï¼Œè¯·è®¡ç®—ä½ æœ€å¤šèƒ½æ‹¿åˆ°å¤šå°‘ä»·å€¼çš„ç¤¼ç‰©ï¼Ÿ

 

ç¤ºä¾‹ 1:

```text
è¾“å…¥: 
[
  [1,3,1],
  [1,5,1],
  [4,2,1]
]
è¾“å‡º: 12
è§£é‡Š: è·¯å¾„ 1â†’3â†’5â†’2â†’1 å¯ä»¥æ‹¿åˆ°æœ€å¤šä»·å€¼çš„ç¤¼ç‰©
```


æç¤ºï¼š

* 0 < grid.length <= 200
* 0 < grid[0].length <= 200

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ã€å›æº¯æ³•ã€BFS, æ˜¾ç„¶æ˜“è§åŠ¨æ€è§„åˆ’æ˜¯æœ€ä¼˜è§£ï¼Œ å¯æ˜¯æˆ‘æœ€å…ˆæƒ³åˆ°çš„BFS(ğŸ˜‚)ã€‚ ä»¥ä¸‹è§£æä»£ç æ˜¯åŸºäºBFSï¼Œ å¾ˆå¥½ç†è§£ä½†æ˜¯ç®—æ³•ä¸æ˜¯æœ€ä¼˜çš„ã€‚

```java
class Solution {

    public int maxValue(int[][] grid) {
        // BFS
        if (grid[0].length == grid.length && grid.length == 1) {
            return grid[0][0];
        }
        int maxRow = grid.length - 1;
        int maxColumn = grid[0].length - 1;

        List<Pair<Integer, Pair<Integer, Integer>>> currentList = new ArrayList<>();
        currentList.add(getPosition(grid[0][0], 0, 0));

        int maxValue = Integer.MIN_VALUE;

        while (!currentList.isEmpty()) {

            Map<Pair<Integer, Integer>, Integer> cache = new HashMap<>();

            List<Pair<Integer, Pair<Integer, Integer>>> tempList = new ArrayList<>();

            for (Pair<Integer, Pair<Integer, Integer>> element : currentList) {
                int giftValue = element.getKey();
                int row = element.getValue().getKey();
                int column = element.getValue().getValue();


                // åˆ°è¾¾ç»ˆç‚¹
                if (row == maxRow && column == maxColumn) {
                    maxValue = Math.max(giftValue, maxValue);
                    continue;
                }

                // å‘å³èµ°
                if (column < maxColumn) {
                    Pair<Integer, Pair<Integer, Integer>> position = getPosition(giftValue + grid[row][column + 1], row, column + 1);
                    if(cache.containsKey(position.getValue())){
                        if(cache.get(position.getValue())<position.getKey()){
                            cache.put(position.getValue(), position.getKey());
                        }
                    }else {
                        cache.put(position.getValue(), position.getKey());
                    }


                }

                // å‘ä¸‹èµ°
                if (row < maxRow) {
                    Pair<Integer, Pair<Integer, Integer>> position = getPosition(giftValue + grid[row + 1][column], row + 1, column);
                    if(cache.containsKey(position.getValue())){
                        if(cache.get(position.getValue())<position.getKey()){
                            cache.put(position.getValue(), position.getKey());
                        }
                    }else {
                        cache.put(position.getValue(), position.getKey());
                    }
                }
            }
            cache.forEach((k,v)->{
                tempList.add(getPosition(v, k));
            });
            currentList = tempList;

        }

        return maxValue;


    }

    /**
     * æ ¹æ® è¡Œåˆ—, å’Œ å½“å‰ç¤¼ç‰©å€¼è¿”å›æŒ‡å®šçš„å¯¹è±¡
     *
     * @param currentValue å½“å‰ç¤¼ç‰©å€¼
     * @param row          è¡Œ
     * @param column       åˆ—
     * @return -
     */
    private Pair<Integer, Pair<Integer, Integer>> getPosition(int currentValue, int row, int column) {
        Pair<Integer, Integer> position = new Pair<>(row, column);
        return new Pair<>(currentValue, position);

    }

    private Pair<Integer, Pair<Integer, Integer>> getPosition(int currentValue, Pair<Integer, Integer> position) {
        return new Pair<>(currentValue, position);

    }

}
```

### DP

è®¾å•å…ƒæ ¼ `dp[i][j]`  è¡¨ç¤º æ¯ä¸ªå½“å‰å•å…ƒæ ¼èƒ½å¤Ÿæ‹¿åˆ°çš„æœ€å¤§ç¤¼ç‰©, æ¯ä¸ªå•å…ƒæ ¼çš„å€¼åªèƒ½æ¥è‡ªä¸¤ä¸ªæ–¹å‘, æ‰€ä»¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹

`dp[i][j] = max{dp[i-1][j], dp[i][j-1] } + grid[i][j]`

```java
class Solution {
    
    public  int maxValue(int[][] grid) {
        
        int m = grid.length, n = grid[0].length;
        
        int[][] dp = new int[m][n];
        
        for (int j = 0;j<n;j++){
            
            for (int i = 0; i<m ; i++){
             
                int maxVale = grid[i][j];
                if(i - 1>=0 ){
                    maxVale = Math.max(maxVale, grid[i][j] + dp[i-1][j]);
                }
                if(j -1 >= 0){
                    maxVale = Math.max(maxVale, grid[i][j] + dp[i][j-1]);
                }
                dp[i][j] = maxVale;
            }
        }
        return dp[m-1][n-1];
        
    }
    
}
```



